## 즉시 갱신 회복 기법 보충설명

#### 1. 즉시 갱신 기법?

트랜잭션 작업이 수행되는 동안에 DB를 즉시 갱신하는 기법으로 비완료 갱신(Uncommitted Update)라고 한다.

- **지연 갱신시 버퍼 용량 부족**으로 문제가 발생할 수 있어 실제 DB는 즉시 갱신을 한다.
- UNDO와 REDO 연산 모두 사용.
  - REDO: 트랜잭션이 commit한 이후에 장애가 발생했을 시.
  - UNDO: commit 이전에 트랜잭션 실행 중 장애가 발생했을 시.
- 보편적으로 많이 사용



#### 2. 즉시 갱신 기법에 대한 의문점

 일반적인 트랜잭션은 commit을 함으로써 데이터 연산 결과를 데이터 베이스에 갱신한다. 이는 트랜잭션 연산 결과를 로그에만 저장했다가 commit시 갱신하는 지연 갱신과 유사하다. 

 그러나 즉시 갱신 기법은 이런 일반적인 트랜잭션 설명과는 다르게 데이터 연산을 수행할 때마다 로그 기록과 함께 DB에도 데이터를 저장한다. 여기에서 드는 의문점은

1. **지연 갱신만 있어도 될 것 같은데? Undo도 안 써도 되고.. 애초에 Undo가 필요할까?**
2. **그런데 즉시 갱신이 보편적으로 쓰인다네? 왜지?**



#### 3. 고찰

 위에 즉시 갱신 기법의 특징을 보면 **"지연 갱신시 버퍼 용량 부족으로 문제가 발생할 수 있어 실제 DB는 즉시 갱신을 한다."** 라는 부분에서 버퍼 용량이 부족하다는데, 이와 관련된 정보를 찾아보았다.
<img src="https://user-images.githubusercontent.com/71415474/110979080-7fb0c380-83a7-11eb-86f1-49737b263cc5.png" alt="image-20210313022609808" style="zoom:80%;" />
<img src="https://user-images.githubusercontent.com/71415474/110979094-82131d80-83a7-11eb-913b-7391c2b3b23f.png" alt="image-20210313023854290" style="zoom:80%;" />

두 글을 통해서 얻은 정보는 아래와 같다.

**1. 로그는 버퍼에 저장된다.**
**2. 버퍼 메모리는 실제 하드디스크에서 16MB, 32MB, 64MB 정도의 적은 비중이 사용된다.**
**3. 버퍼 메모리의 양을 초과하여 로그가 저장될 경우 로그 정보를 잃게 되어 침해 사고와 침입 흔적을 알 수 없는 불상사 발생.**



#### 4. 정리

**"DB마다 로그를 저장하는 버퍼 메모리는 다르겠지만, 공간이 작고, 메모리를 초과할 경우 로그 정보를  잃게 될 수 있어 DB에 비완료 갱신을 하는 즉시  필요가 있다.**
 **Undo는 즉시 갱신에서 비완료 갱신에 대해 장애를 복구하는 방법이다."**

---

### Reference

- https://m.blog.naver.com/dbdlfgo1/221188309077
- https://r1.community.samsung.com/t5/%EA%B0%A4%EB%9F%AD%EC%8B%9C-s/%EB%A1%9C%EA%B1%B0-%EB%B2%84%ED%8D%BC-%ED%81%AC%EA%B8%B0%EB%A5%BC-%ED%82%A4%EC%9A%B0%EB%A9%B4-%EC%A0%95%EB%A7%90-%EC%86%8D%EB%8F%84%EA%B0%80-%EB%B9%A8%EB%9D%BC%EC%A7%80%EB%82%98%EC%9A%94/td-p/3036434

- https://library.gabia.com/contents/infrahosting/1242/